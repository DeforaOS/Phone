targets=hayes,modems,pdu,plugins,ussd,tests.log
cppflags_force=-I ../include
cflags_force=-W
cflags=-Wall -g -O2
ldflags_force=-W
dist=Makefile,tests.sh

[hayes]
type=binary
cflags=`pkg-config --cflags glib-2.0 libSystem`
ldflags=`pkg-config --libs glib-2.0 libSystem`
sources=hayes.c
depends=../src/modems/hayes.c

[modems]
type=binary
cflags=`pkg-config --cflags libDesktop`
ldflags=`pkg-config --libs libDesktop`
sources=modems.c

[pdu]
type=binary
cflags=`pkg-config --cflags glib-2.0 libSystem`
ldflags=`pkg-config --libs glib-2.0 libSystem`
sources=pdu.c

[pdu.c]
cppflags=-I ../src/modems
depends=../src/modems/hayes.c,../src/modems/hayes/command.c,../src/modems/hayes/command.h

[plugins]
type=binary
cflags=`pkg-config --cflags libDesktop`
ldflags=`pkg-config --libs libDesktop`
sources=plugins.c

[tests.log]
type=script
script=./tests.sh
depends=hayes,modems,pdu,plugins,tests.sh,ussd

[ussd]
type=binary
cflags=`pkg-config --cflags glib-2.0 libSystem`
ldflags=`pkg-config --libs glib-2.0 libSystem`
sources=ussd.c

[ussd.c]
cppflags=-I ../src/modems
depends=../src/modems/hayes.c,../src/modems/hayes/command.c,../src/modems/hayes/command.h
